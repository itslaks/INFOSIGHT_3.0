<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFOCRYPT - Professional Cryptographic Suite</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #ff6b35;
            --primary-dark: #e85a28;
            --accent: #00d4aa;
            --accent-dark: #00b894;
            --bg-dark: #0a0e27;
            --bg-darker: #050814;
            --bg-card: rgba(26, 31, 58, 0.8);
            --text-primary: #ffffff;
            --text-secondary: #b8c5d6;
            --text-muted: #6b7a94;
            --success: #00d4aa;
            --error: #ff4757;
            --warning: #ffc947;
            --border: rgba(42, 49, 80, 0.6);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        header {
            text-align: center;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        /* Tab Navigation */
        .tab-nav {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            background: var(--bg-card);
            padding: 1rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .tab-btn {
            padding: 1rem;
            background: transparent;
            border: 2px solid transparent;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
        }

        .tab-btn.active {
            color: var(--text-primary);
            background: rgba(255, 107, 53, 0.15);
            border-color: var(--primary);
        }

        .tab-emoji {
            font-size: 1.8rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Layout */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            align-items: start;
        }

        /* Card */
        .card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--border);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* Help Sidebar */
        .help-sidebar {
            position: sticky;
            top: 2rem;
        }

        .help-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .help-title {
            font-size: 1.1rem;
            font-weight: 800;
            margin-bottom: 1rem;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .help-text {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }

        .help-list {
            list-style: none;
            padding: 0;
        }

        .help-list li {
            padding: 0.5rem 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .help-list li::before {
            content: '‚Üí';
            color: var(--primary);
            font-weight: bold;
        }

        /* Info Box */
        .info-box {
            background: linear-gradient(135deg, rgba(0, 212, 170, 0.1), rgba(0, 212, 170, 0.05));
            border: 2px solid var(--accent);
            border-left: 4px solid var(--accent);
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1.5rem 0;
            display: flex;
            gap: 1rem;
        }

        .info-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .info-content {
            flex: 1;
        }

        .info-title {
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .info-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .warning-box {
            background: linear-gradient(135deg, rgba(255, 201, 71, 0.1), rgba(255, 201, 71, 0.05));
            border: 2px solid var(--warning);
            border-left: 4px solid var(--warning);
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1.5rem 0;
            display: flex;
            gap: 1rem;
        }

        .warning-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .warning-title {
            font-weight: 700;
            color: var(--warning);
            margin-bottom: 0.5rem;
        }

        .warning-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .label-hint {
            color: var(--text-muted);
            font-weight: 400;
            font-size: 0.85rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 0.875rem 1rem;
            background: rgba(10, 14, 39, 0.6);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(10, 14, 39, 0.8);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.2);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
            line-height: 1.6;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23ff6b35' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 3rem;
            font-family: 'Inter', sans-serif;
        }

        .char-counter {
            text-align: right;
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .btn-secondary {
            background: rgba(26, 31, 58, 0.8);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: rgba(26, 31, 58, 1);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 212, 170, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn:active:not(:disabled) {
            transform: translateY(0) scale(0.98);
        }

        /* Result Display */
        .result-box {
            background: rgba(10, 14, 39, 0.6);
            border: 2px solid var(--border);
            border-radius: 16px;
            margin-top: 2rem;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: rgba(255, 107, 53, 0.1);
            border-bottom: 2px solid var(--border);
        }

        .result-title {
            color: var(--primary);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn {
            background: rgba(26, 31, 58, 0.8);
            border: 2px solid var(--border);
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .result-content {
            padding: 1.5rem;
            color: var(--text-primary);
            word-break: break-all;
            line-height: 1.8;
            font-size: 0.95rem;
            font-family: 'JetBrains Mono', monospace;
            max-height: 400px;
            overflow-y: auto;
        }

        .result-content::-webkit-scrollbar {
            width: 8px;
        }

        .result-content::-webkit-scrollbar-track {
            background: rgba(26, 31, 58, 0.5);
        }

        .result-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* Key Display */
        .key-display {
            background: rgba(10, 14, 39, 0.6);
            border: 2px dashed var(--border);
            border-radius: 16px;
            margin-top: 1.5rem;
            overflow: hidden;
        }

        .key-item {
            border-bottom: 1px solid var(--border);
            padding: 1.5rem;
        }

        .key-item:last-child {
            border-bottom: none;
        }

        .key-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .key-label {
            color: var(--accent);
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .key-copy-btn {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-muted);
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .key-copy-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .key-value {
            background: rgba(5, 8, 20, 0.6);
            padding: 1rem;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            word-break: break-all;
            color: var(--text-secondary);
            line-height: 1.8;
            max-height: 200px;
            overflow-y: auto;
        }

        /* Alert */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            animation: alertSlide 0.3s ease;
        }

        @keyframes alertSlide {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .alert-success {
            background: rgba(0, 212, 170, 0.15);
            border: 2px solid var(--success);
            color: var(--success);
        }

        .alert-error {
            background: rgba(255, 71, 87, 0.15);
            border: 2px solid var(--error);
            color: var(--error);
        }

        .alert-icon {
            font-size: 1.5rem;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Checkbox */
        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(26, 31, 58, 0.6);
            border-radius: 12px;
            border: 2px solid var(--border);
        }

        .checkbox-wrapper input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checkbox-wrapper label {
            margin: 0;
            cursor: pointer;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .two-column {
                grid-template-columns: 1fr;
            }

            .help-sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .tab-nav {
                grid-template-columns: 1fr 1fr;
            }

            .card {
                padding: 1.5rem;
            }

            .btn-group {
                flex-direction: column;
            }
        }

        /* Step Instructions */
        .step-guide {
            background: rgba(0, 212, 170, 0.05);
            border: 2px solid var(--accent);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .step-guide-title {
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .step {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: flex-start;
        }

        .step:last-child {
            margin-bottom: 0;
        }

        .step-number {
            background: var(--accent);
            color: var(--bg-dark);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .step-text {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">üõ°Ô∏è</div>
                <div>
                    <h1>INFOCRYPT</h1>
                    <p class="subtitle">Professional Cryptographic Suite</p>
                </div>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('hash')">
                <span class="tab-emoji">üîê</span>
                <span>Hash</span>
            </button>
            <button class="tab-btn" onclick="switchTab('encrypt')">
                <span class="tab-emoji">üîí</span>
                <span>Encrypt</span>
            </button>
            <button class="tab-btn" onclick="switchTab('decrypt')">
                <span class="tab-emoji">üîì</span>
                <span>Decrypt</span>
            </button>
            <button class="tab-btn" onclick="switchTab('keygen')">
                <span class="tab-emoji">‚ö°</span>
                <span>Key Gen</span>
            </button>
            <button class="tab-btn" onclick="switchTab('verify')">
                <span class="tab-emoji">‚úÖ</span>
                <span>Verify</span>
            </button>
        </nav>

        <!-- Hash Tab -->
        <div class="tab-content active" id="hash-tab">
            <div class="two-column">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>üîê</span>
                            Hash Generator
                        </div>
                    </div>

                    <div class="step-guide">
                        <div class="step-guide-title">üìñ How Hashing Works</div>
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">Enter Your Text</div>
                                <div class="step-text">Type or paste any text you want to hash</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">Choose Algorithm</div>
                                <div class="step-text">SHA-256 is recommended for most uses</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-title">Generate Hash</div>
                                <div class="step-text">Click Generate to create a unique hash value</div>
                            </div>
                        </div>
                    </div>

                    <form id="hash-form" onsubmit="handleHash(event)">
                        <div class="form-group">
                            <label>
                                <span>üìù</span>
                                Input Text
                                <span class="label-hint">(text to hash)</span>
                            </label>
                            <textarea id="hash-text" placeholder="Enter your text here..." required></textarea>
                            <div class="char-counter" id="hash-counter">0 characters</div>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üéØ</span>
                                Hash Algorithm
                                <span class="label-hint">(recommended: SHA-256)</span>
                            </label>
                            <select id="hash-algorithm" required>
                                <optgroup label="Recommended">
                                    <option value="SHA-256" selected>SHA-256</option>
                                    <option value="SHA-512">SHA-512</option>
                                    <option value="SHA3-256">SHA3-256</option>
                                    <option value="BLAKE2b">BLAKE2b</option>
                                </optgroup>
                                <optgroup label="Other Options">
                                    <option value="SHA-384">SHA-384</option>
                                    <option value="SHA-224">SHA-224</option>
                                    <option value="SHA3-512">SHA3-512</option>
                                    <option value="SHA3-384">SHA3-384</option>
                                    <option value="SHA3-224">SHA3-224</option>
                                    <option value="BLAKE2s">BLAKE2s</option>
                                </optgroup>
                                <optgroup label="Legacy (Not Recommended)">
                                    <option value="MD5">MD5</option>
                                    <option value="SHA-1">SHA-1</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üîÅ</span>
                                Iterations
                                <span class="label-hint">(1 for basic hash)</span>
                            </label>
                            <input type="number" id="hash-iterations" value="1" min="1" max="1000000">
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span>üöÄ</span>
                                Generate Hash
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm('hash')">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </form>

                    <div id="hash-result"></div>
                </div>

                <div class="help-sidebar">
                    <div class="help-card">
                        <div class="help-title">
                            <span>üí°</span>
                            What is Hashing?
                        </div>
                        <p class="help-text">Hashing creates a unique fixed-length fingerprint of your data. It's one-way (cannot be reversed) and perfect for:</p>
                        <ul class="help-list">
                            <li>Verifying file integrity</li>
                            <li>Storing passwords securely</li>
                            <li>Creating unique identifiers</li>
                            <li>Digital signatures</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <span class="warning-icon">‚ö†Ô∏è</span>
                        <div>
                            <div class="warning-title">Security Note</div>
                            <div class="warning-text">MD5 and SHA-1 are deprecated. Use SHA-256 or newer algorithms for security.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Encrypt Tab -->
        <div class="tab-content" id="encrypt-tab">
            <div class="two-column">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>üîí</span>
                            Data Encryption
                        </div>
                    </div>

                    <div class="step-guide">
                        <div class="step-guide-title">üìñ How to Encrypt Data</div>
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">Enter Your Message</div>
                                <div class="step-text">Type the text you want to protect</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">Choose Algorithm</div>
                                <div class="step-text">Select encryption type (AES-256-GCM recommended)</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-title">Key Options</div>
                                <div class="step-text">Leave empty to auto-generate or provide your own</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <div class="step-title">Save Your Key!</div>
                                <div class="step-text">CRITICAL: Copy and save the encryption key securely</div>
                            </div>
                        </div>
                    </div>

                    <form id="encrypt-form" onsubmit="handleEncrypt(event)">
                        <div class="form-group">
                            <label>
                                <span>üìÑ</span>
                                Plaintext
                                <span class="label-hint">(text to encrypt)</span>
                            </label>
                            <textarea id="encrypt-text" placeholder="Enter your secret message..." required></textarea>
                            <div class="char-counter" id="encrypt-counter">0 characters</div>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üõ°Ô∏è</span>
                                Encryption Algorithm
                            </label>
                            <select id="encrypt-algorithm" required>
                                <optgroup label="Recommended (Authenticated)">
                                    <option value="AES-256-GCM" selected>AES-256-GCM</option>
                                    <option value="AES-192-GCM">AES-192-GCM</option>
                                    <option value="AES-128-GCM">AES-128-GCM</option>
                                    <option value="ChaCha20-Poly1305">ChaCha20-Poly1305</option>
                                </optgroup>
                                <optgroup label="Standard (CBC Mode)">
                                    <option value="AES-256-CBC">AES-256-CBC</option>
                                    <option value="AES-192-CBC">AES-192-CBC</option>
                                    <option value="AES-128-CBC">AES-128-CBC</option>
                                </optgroup>
                                <optgroup label="Other Options">
                                    <option value="AES-256-CTR">AES-256-CTR</option>
                                    <option value="AES-128-CTR">AES-128-CTR</option>
                                    <option value="Fernet">Fernet</option>
                                    <option value="TripleDES">TripleDES</option>
                                </optgroup>
                                <optgroup label="Asymmetric (Public Key)">
                                    <option value="RSA-2048">RSA-2048</option>
                                    <option value="RSA-4096">RSA-4096</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üîë</span>
                                Encryption Key
                                <span class="label-hint">(leave empty to auto-generate)</span>
                            </label>
                            <input type="text" id="encrypt-key" placeholder="Optional - auto-generate if empty">
                        </div>

                        <div class="checkbox-wrapper">
                            <input type="checkbox" id="use-password">
                            <label for="use-password">
                                <strong>Use Password-Based Encryption</strong>
                                <span class="label-hint"> (derive key from password)</span>
                            </label>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span>üîí</span>
                                Encrypt Data
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm('encrypt')">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </form>

                    <div id="encrypt-result"></div>
                </div>

                <div class="help-sidebar">
                    <div class="help-card">
                        <div class="help-title">
                            <span>üí°</span>
                            About Encryption
                        </div>
                        <p class="help-text">Encryption scrambles your data using a secret key. Only someone with the correct key can decrypt it.</p>
                    </div>

                    <div class="help-card">
                        <div class="help-title">
                            <span>üéØ</span>
                            Which Key to Save?
                        </div>
                        <ul class="help-list">
                            <li><strong>Symmetric (AES, ChaCha):</strong> Save the "Encryption Key"</li>
                            <li><strong>RSA:</strong> Save the "Private Key" (keep it secret!)</li>
                            <li><strong>Password-based:</strong> Remember your password</li>
                        </ul>
                    </div>

                    <div class="warning-box">
                        <span class="warning-icon">üîê</span>
                        <div>
                            <div class="warning-title">Critical: Save Your Keys!</div>
                            <div class="warning-text">Without the key, your encrypted data CANNOT be recovered. Store keys in a secure password manager immediately!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decrypt Tab -->
        <div class="tab-content" id="decrypt-tab">
            <div class="two-column">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>üîì</span>
                            Data Decryption
                        </div>
                    </div>

                    <div class="step-guide">
                        <div class="step-guide-title">üìñ How to Decrypt Data</div>
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <div class="step-title">Paste Ciphertext</div>
                                <div class="step-text">Copy and paste the encrypted text</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <div class="step-title">Match Algorithm</div>
                                <div class="step-text">Select the SAME algorithm used to encrypt</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <div class="step-title">Provide Key</div>
                                <div class="step-text">Paste the encryption key (or private key for RSA)</div>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <div class="step-title">Decrypt & Read</div>
                                <div class="step-text">Click Decrypt to reveal your original message</div>
                            </div>
                        </div>
                    </div>

                    <form id="decrypt-form" onsubmit="handleDecrypt(event)">
                        <div class="form-group">
                            <label>
                                <span>üîê</span>
                                Ciphertext
                                <span class="label-hint">(encrypted data)</span>
                            </label>
                            <textarea id="decrypt-text" placeholder="Paste encrypted text here..." required></textarea>
                            <div class="char-counter" id="decrypt-counter">0 characters</div>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üõ°Ô∏è</span>
                                Decryption Algorithm
                                <span class="label-hint">(must match encryption)</span>
                            </label>
                            <select id="decrypt-algorithm" required>
                                <optgroup label="Recommended">
                                    <option value="AES-256-GCM" selected>AES-256-GCM</option>
                                    <option value="AES-192-GCM">AES-192-GCM</option>
                                    <option value="AES-128-GCM">AES-128-GCM</option>
                                    <option value="ChaCha20-Poly1305">ChaCha20-Poly1305</option>
                                </optgroup>
                                <optgroup label="Standard">
                                    <option value="AES-256-CBC">AES-256-CBC</option>
                                    <option value="AES-192-CBC">AES-192-CBC</option>
                                    <option value="AES-128-CBC">AES-128-CBC</option>
                                </optgroup>
                                <optgroup label="Other">
                                    <option value="AES-256-CTR">AES-256-CTR</option>
                                    <option value="AES-128-CTR">AES-128-CTR</option>
                                    <option value="Fernet">Fernet</option>
                                    <option value="TripleDES">TripleDES</option>
                                    <option value="RSA-2048">RSA-2048</option>
                                    <option value="RSA-4096">RSA-4096</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üîë</span>
                                Decryption Key
                                <span class="label-hint">(or private key for RSA)</span>
                            </label>
                            <input type="text" id="decrypt-key" placeholder="Paste your key here" required>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span>üîì</span>
                                Decrypt Data
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm('decrypt')">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </form>

                    <div id="decrypt-result"></div>
                </div>

                <div class="help-sidebar">
                    <div class="help-card">
                        <div class="help-title">
                            <span>üí°</span>
                            Decryption Tips
                        </div>
                        <ul class="help-list">
                            <li>Algorithm must match encryption</li>
                            <li>Use exact key from encryption</li>
                            <li>For RSA, use Private Key</li>
                            <li>Check for extra spaces in key</li>
                        </ul>
                    </div>

                    <div class="help-card">
                        <div class="help-title">
                            <span>‚ö†Ô∏è</span>
                            Common Errors
                        </div>
                        <ul class="help-list">
                            <li><strong>Wrong key:</strong> Decryption will fail</li>
                            <li><strong>Wrong algorithm:</strong> Must match exactly</li>
                            <li><strong>Corrupted data:</strong> Copy full ciphertext</li>
                            <li><strong>Password-based:</strong> Use salt if provided</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Key Generation Tab -->
        <div class="tab-content" id="keygen-tab">
            <div class="two-column">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>‚ö°</span>
                            Key Generator
                        </div>
                    </div>

                    <div class="info-box">
                        <span class="info-icon">üí°</span>
                        <div class="info-content">
                            <div class="info-title">Why Generate Keys?</div>
                            <div class="info-text">Strong random keys are essential for secure encryption. Our generator uses cryptographically secure methods to create unguessable keys.</div>
                        </div>
                    </div>

                    <form id="keygen-form" onsubmit="handleKeyGen(event)">
                        <div class="form-group">
                            <label>
                                <span>üéØ</span>
                                Select Algorithm
                            </label>
                            <select id="keygen-algorithm" required>
                                <optgroup label="Recommended">
                                    <option value="AES-256-GCM" selected>AES-256-GCM (256-bit)</option>
                                    <option value="AES-192-GCM">AES-192-GCM (192-bit)</option>
                                    <option value="AES-128-GCM">AES-128-GCM (128-bit)</option>
                                    <option value="ChaCha20-Poly1305">ChaCha20-Poly1305 (256-bit)</option>
                                </optgroup>
                                <optgroup label="Other Symmetric">
                                    <option value="AES-256-CBC">AES-256-CBC</option>
                                    <option value="AES-256-CTR">AES-256-CTR</option>
                                    <option value="Fernet">Fernet</option>
                                    <option value="TripleDES">TripleDES</option>
                                </optgroup>
                                <optgroup label="Asymmetric (RSA)">
                                    <option value="RSA-2048">RSA-2048</option>
                                    <option value="RSA-4096">RSA-4096</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="warning-box">
                            <span class="warning-icon">üîê</span>
                            <div>
                                <div class="warning-title">Critical: Save Generated Keys!</div>
                                <div class="warning-text">
                                    After generating, immediately copy and save your key(s) in a secure password manager like 1Password, LastPass, or Bitwarden.
                                    <br><br>
                                    ‚úì For symmetric algorithms: Save the encryption key<br>
                                    ‚úì For RSA: Save BOTH public and private keys
                                </div>
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-success">
                                <span>‚ö°</span>
                                Generate Key
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm('keygen')">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </form>

                    <div id="keygen-result"></div>
                </div>

                <div class="help-sidebar">
                    <div class="help-card">
                        <div class="help-title">
                            <span>üìö</span>
                            Key Types Explained
                        </div>
                        <p class="help-text"><strong>Symmetric Keys (AES, ChaCha):</strong></p>
                        <p class="help-text">One key for both encryption and decryption. Faster and suitable for most uses.</p>
                        <br>
                        <p class="help-text"><strong>Asymmetric Keys (RSA):</strong></p>
                        <p class="help-text">Two keys: Public key for encryption, Private key for decryption. Used for secure key exchange.</p>
                    </div>

                    <div class="help-card">
                        <div class="help-title">
                            <span>üéØ</span>
                            Key Size Guide
                        </div>
                        <ul class="help-list">
                            <li><strong>128-bit:</strong> Fast, secure for most uses</li>
                            <li><strong>256-bit:</strong> Maximum security</li>
                            <li><strong>RSA-2048:</strong> Standard asymmetric</li>
                            <li><strong>RSA-4096:</strong> Maximum asymmetric security</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Verify Tab -->
        <div class="tab-content" id="verify-tab">
            <div class="two-column">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <span>‚úÖ</span>
                            Hash Verification
                        </div>
                    </div>

                    <div class="info-box">
                        <span class="info-icon">üí°</span>
                        <div class="info-content">
                            <div class="info-title">Why Verify Hashes?</div>
                            <div class="info-text">Hash verification confirms data integrity. Perfect for checking if files are authentic or if your data hasn't been tampered with.</div>
                        </div>
                    </div>

                    <h3 style="margin-bottom: 1rem; color: var(--text-primary); font-size: 1.3rem; font-weight: 700;">
                        üîç Compare Two Hashes
                    </h3>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="form-group">
                            <label>
                                <span>1Ô∏è‚É£</span>
                                First Hash
                            </label>
                            <textarea id="compare-hash1" placeholder="Paste first hash..." style="min-height: 100px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>2Ô∏è‚É£</span>
                                Second Hash
                            </label>
                            <textarea id="compare-hash2" placeholder="Paste second hash..." style="min-height: 100px;"></textarea>
                        </div>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="compareHashes()">
                            <span>‚öñÔ∏è</span>
                            Compare Hashes
                        </button>
                        <button class="btn btn-secondary" onclick="clearCompare()">
                            <span>üóëÔ∏è</span>
                            Clear
                        </button>
                    </div>

                    <div id="compare-result"></div>

                    <hr style="border: none; border-top: 2px solid var(--border); margin: 2.5rem 0;">

                    <h3 style="margin-bottom: 1rem; color: var(--text-primary); font-size: 1.3rem; font-weight: 700;">
                        ‚úÖ Verify Data Against Hash
                    </h3>

                    <form id="verify-form" onsubmit="handleVerify(event)">
                        <div class="form-group">
                            <label>
                                <span>üìù</span>
                                Input Text
                            </label>
                            <textarea id="verify-text" placeholder="Enter original text..." required></textarea>
                            <div class="char-counter" id="verify-counter">0 characters</div>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üîê</span>
                                Expected Hash
                            </label>
                            <textarea id="verify-hash" placeholder="Paste hash to verify..." required style="min-height: 100px;"></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <span>üéØ</span>
                                Hash Algorithm
                            </label>
                            <select id="verify-algorithm" required>
                                <option value="SHA-256" selected>SHA-256</option>
                                <option value="SHA-512">SHA-512</option>
                                <option value="SHA3-256">SHA3-256</option>
                                <option value="BLAKE2b">BLAKE2b</option>
                                <option value="MD5">MD5</option>
                                <option value="SHA-1">SHA-1</option>
                            </select>
                        </div>

                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span>‚úÖ</span>
                                Verify Hash
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="clearForm('verify')">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </form>

                    <div id="verify-result"></div>
                </div>

                <div class="help-sidebar">
                    <div class="help-card">
                        <div class="help-title">
                            <span>üí°</span>
                            Verification Methods
                        </div>
                        <p class="help-text"><strong>Compare Hashes:</strong> Check if two hash values are identical.</p>
                        <br>
                        <p class="help-text"><strong>Verify Data:</strong> Hash your text and compare it to an expected hash value.</p>
                    </div>

                    <div class="help-card">
                        <div class="help-title">
                            <span>üéØ</span>
                            Use Cases
                        </div>
                        <ul class="help-list">
                            <li>Verify downloaded files</li>
                            <li>Check data integrity</li>
                            <li>Validate passwords</li>
                            <li>Detect tampering</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.origin + '/infocrypt/api';

        // Character counters
        function setupCounter(textareaId, counterId) {
            const textarea = document.getElementById(textareaId);
            const counter = document.getElementById(counterId);
            
            if (textarea && counter) {
                textarea.addEventListener('input', () => {
                    counter.textContent = `${textarea.value.length} characters`;
                });
            }
        }

        // Initialize counters
        setupCounter('hash-text', 'hash-counter');
        setupCounter('encrypt-text', 'encrypt-counter');
        setupCounter('decrypt-text', 'decrypt-counter');
        setupCounter('verify-text', 'verify-counter');

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.closest('.tab-btn').classList.add('active');
        }

        // Show alert
        function showAlert(message, type = 'success') {
            const alerts = document.querySelectorAll('.alert');
            alerts.forEach(a => a.remove());

            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
            const icon = type === 'success' ? '‚úÖ' : '‚ùå';
            
            const alert = document.createElement('div');
            alert.className = `alert ${alertClass}`;
            alert.innerHTML = `<span class="alert-icon">${icon}</span><span>${message}</span>`;
            
            document.querySelector('.container').insertBefore(alert, document.querySelector('.tab-nav'));
            
            setTimeout(() => alert.remove(), 5000);
        }

        // Loading state
        function showLoading(button) {
            const original = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<div class="loading"></div><span>Processing...</span>';
            return original;
        }

        function hideLoading(button, original) {
            button.disabled = false;
            button.innerHTML = original;
        }

        // Copy to clipboard
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showAlert('‚úÖ Copied to clipboard!', 'success');
                
                const button = event.target.closest('.copy-btn, .key-copy-btn');
                if (button) {
                    const originalText = button.innerHTML;
                    button.innerHTML = '<span>‚úì Copied!</span>';
                    setTimeout(() => {
                        button.innerHTML = originalText;
                    }, 2000);
                }
            }).catch(() => {
                showAlert('‚ùå Failed to copy', 'error');
            });
        }

        // Hash
        async function handleHash(event) {
            event.preventDefault();
            
            const button = event.target.querySelector('button[type="submit"]');
            const original = showLoading(button);
            
            try {
                const text = document.getElementById('hash-text').value;
                const algorithm = document.getElementById('hash-algorithm').value;
                const iterations = parseInt(document.getElementById('hash-iterations').value);
                
                const response = await fetch(`${API_BASE}/hash`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, algorithm, iterations })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayHashResult(data.data);
                    showAlert(`‚úÖ Hash generated with ${algorithm}`, 'success');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading(button, original);
            }
        }

        function displayHashResult(data) {
            const resultId = 'hash-result-' + Date.now();
            const html = `
                <div class="result-box">
                    <div class="result-header">
                        <span class="result-title"><span>‚úÖ</span> Hash Result</span>
                        <button class="copy-btn" onclick="copyToClipboard('${resultId}')">
                            <span>üìã</span> Copy
                        </button>
                    </div>
                    <div class="result-content" id="${resultId}">${data.hash}</div>
                </div>
                <div class="key-display">
                    <div class="key-item">
                        <div class="key-label"><span>üõ°Ô∏è</span> Algorithm</div>
                        <div class="key-value">${data.algorithm}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üìè</span> Length</div>
                        <div class="key-value">${data.length} characters (${data.bits} bits)</div>
                    </div>
                </div>
            `;
            
            document.getElementById('hash-result').innerHTML = html;
        }

        // Encrypt
        async function handleEncrypt(event) {
            event.preventDefault();
            
            const button = event.target.querySelector('button[type="submit"]');
            const original = showLoading(button);
            
            try {
                const text = document.getElementById('encrypt-text').value;
                const algorithm = document.getElementById('encrypt-algorithm').value;
                const key = document.getElementById('encrypt-key').value;
                const usePassword = document.getElementById('use-password').checked;
                
                const response = await fetch(`${API_BASE}/encrypt`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, algorithm, key, use_password: usePassword })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayEncryptResult(data.data);
                    showAlert(`‚úÖ Data encrypted with ${algorithm}`, 'success');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading(button, original);
            }
        }

        function displayEncryptResult(data) {
            const ciphertextId = 'cipher-' + Date.now();
            const keyId = 'key-' + Date.now();
            const privateKeyId = 'private-' + Date.now();
            const publicKeyId = 'public-' + Date.now();
            
            let keyHtml = '';
            
            if (data.private_key && data.public_key) {
                keyHtml = `
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîê</span> Private Key (SAVE THIS!)</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${privateKeyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${privateKeyId}">${data.private_key}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîì</span> Public Key</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${publicKeyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${publicKeyId}">${data.public_key}</div>
                    </div>
                `;
            } else if (data.key) {
                keyHtml = `
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîë</span> Encryption Key (SAVE THIS!)</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${keyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${keyId}">${data.key}</div>
                    </div>
                `;
            }
            
            const html = `
                <div class="result-box">
                    <div class="result-header">
                        <span class="result-title"><span>üîê</span> Encrypted Data</span>
                        <button class="copy-btn" onclick="copyToClipboard('${ciphertextId}')">
                            <span>üìã</span> Copy
                        </button>
                    </div>
                    <div class="result-content" id="${ciphertextId}">${data.ciphertext}</div>
                </div>
                <div class="key-display">
                    ${keyHtml}
                    ${data.salt ? `
                    <div class="key-item">
                        <div class="key-label"><span>üßÇ</span> Salt (save for decryption)</div>
                        <div class="key-value">${data.salt}</div>
                    </div>` : ''}
                </div>
                ${data.private_key || data.key ? `
                <div class="warning-box" style="margin-top: 1.5rem;">
                    <span class="warning-icon">‚ö†Ô∏è</span>
                    <div>
                        <div class="warning-title">SAVE YOUR KEY NOW!</div>
                        <div class="warning-text">Copy and securely store the key above. Without it, you CANNOT decrypt this data!</div>
                    </div>
                </div>` : ''}
            `;
            
            document.getElementById('encrypt-result').innerHTML = html;
        }

        // Decrypt
        async function handleDecrypt(event) {
            event.preventDefault();
            
            const button = event.target.querySelector('button[type="submit"]');
            const original = showLoading(button);
            
            try {
                const ciphertext = document.getElementById('decrypt-text').value;
                const algorithm = document.getElementById('decrypt-algorithm').value;
                const key = document.getElementById('decrypt-key').value;
                
                const response = await fetch(`${API_BASE}/decrypt`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        ciphertext, 
                        algorithm, 
                        key,
                        private_key: algorithm.includes('RSA') ? key : null
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayDecryptResult(data.data);
                    showAlert('‚úÖ Data decrypted successfully', 'success');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading(button, original);
            }
        }

        function displayDecryptResult(data) {
            const plaintextId = 'plaintext-' + Date.now();
            const html = `
                <div class="result-box">
                    <div class="result-header">
                        <span class="result-title"><span>‚úÖ</span> Decrypted Data</span>
                        <button class="copy-btn" onclick="copyToClipboard('${plaintextId}')">
                            <span>üìã</span> Copy
                        </button>
                    </div>
                    <div class="result-content" id="${plaintextId}">${data.plaintext}</div>
                </div>
            `;
            
            document.getElementById('decrypt-result').innerHTML = html;
        }

        // Key Generation
        async function handleKeyGen(event) {
            event.preventDefault();
            
            const button = event.target.querySelector('button[type="submit"]');
            const original = showLoading(button);
            
            try {
                const algorithm = document.getElementById('keygen-algorithm').value;
                
                const response = await fetch(`${API_BASE}/generate-key`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ algorithm })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayKeyGenResult(data.data);
                    showAlert(`‚úÖ Secure key generated for ${algorithm}`, 'success');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading(button, original);
            }
        }

        function displayKeyGenResult(data) {
            const keyId = 'gen-key-' + Date.now();
            const privateKeyId = 'gen-private-' + Date.now();
            const publicKeyId = 'gen-public-' + Date.now();
            
            let keyHtml = '';
            
            if (data.private_key && data.public_key) {
                keyHtml = `
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîê</span> Private Key</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${privateKeyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${privateKeyId}">${data.private_key}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîì</span> Public Key</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${publicKeyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${publicKeyId}">${data.public_key}</div>
                    </div>
                `;
            } else {
                keyHtml = `
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîë</span> Generated Key</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${keyId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${keyId}">${data.key}</div>
                    </div>
                `;
            }
            
            const html = `
                <div class="alert alert-success">
                    <span class="alert-icon">‚úÖ</span>
                    <span>Cryptographically secure key generated successfully!</span>
                </div>
                <div class="key-display">
                    ${keyHtml}
                    <div class="key-item">
                        <div class="key-label"><span>üÜî</span> Key ID</div>
                        <div class="key-value">${data.key_id}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üõ°Ô∏è</span> Algorithm</div>
                        <div class="key-value">${data.algorithm}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üìè</span> Key Size</div>
                        <div class="key-value">${data.key_size} bits</div>
                    </div>
                </div>
                <div class="warning-box" style="margin-top: 1.5rem;">
                    <span class="warning-icon">‚ö†Ô∏è</span>
                    <div>
                        <div class="warning-title">Save This Key Immediately!</div>
                        <div class="warning-text">Copy the key above and store it in a secure password manager. This is your only chance to save it!</div>
                    </div>
                </div>
            `;
            
            document.getElementById('keygen-result').innerHTML = html;
        }

        // Compare Hashes
        async function compareHashes() {
            const hash1 = document.getElementById('compare-hash1').value.trim();
            const hash2 = document.getElementById('compare-hash2').value.trim();
            
            if (!hash1 || !hash2) {
                showAlert('‚ùå Please enter both hash values', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/compare`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ hash1, hash2 })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayCompareResult(data.data);
                    const match = data.data.match;
                    showAlert(match ? '‚úÖ Hashes match!' : '‚ùå Hashes do not match', match ? 'success' : 'error');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        function displayCompareResult(data) {
            const match = data.match;
            const html = `
                <div class="alert ${match ? 'alert-success' : 'alert-error'}">
                    <span class="alert-icon">${match ? '‚úÖ' : '‚ùå'}</span>
                    <span><strong>${match ? 'MATCH' : 'NO MATCH'}</strong> - Hashes are ${match ? 'identical' : 'different'}</span>
                </div>
                <div class="key-display">
                    <div class="key-item">
                        <div class="key-label"><span>üìä</span> Result</div>
                        <div class="key-value">${match ? '‚úÖ Hashes Match' : '‚ùå Hashes Do Not Match'}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üìè</span> Hash Lengths</div>
                        <div class="key-value">Hash 1: ${data.hash1_length} | Hash 2: ${data.hash2_length}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('compare-result').innerHTML = html;
        }

        // Verify Hash
        async function handleVerify(event) {
            event.preventDefault();
            
            const button = event.target.querySelector('button[type="submit"]');
            const original = showLoading(button);
            
            try {
                const text = document.getElementById('verify-text').value;
                const hash = document.getElementById('verify-hash').value.trim();
                const algorithm = document.getElementById('verify-algorithm').value;
                
                const response = await fetch(`${API_BASE}/verify`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, hash, algorithm })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayVerifyResult(data.data);
                    const verified = data.data.verified;
                    showAlert(verified ? '‚úÖ Verification successful!' : '‚ùå Verification failed', verified ? 'success' : 'error');
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                showAlert(`‚ùå Error: ${error.message}`, 'error');
            } finally {
                hideLoading(button, original);
            }
        }

        function displayVerifyResult(data) {
            const computedHashId = 'computed-' + Date.now();
            const verified = data.verified;
            
            const html = `
                <div class="alert ${verified ? 'alert-success' : 'alert-error'}">
                    <span class="alert-icon">${verified ? '‚úÖ' : '‚ùå'}</span>
                    <span><strong>${verified ? 'VERIFIED' : 'FAILED'}</strong> - ${verified ? 'Data is authentic' : 'Data does not match'}</span>
                </div>
                <div class="key-display">
                    <div class="key-item">
                        <div class="key-header">
                            <span class="key-label"><span>üîç</span> Computed Hash</span>
                            <button class="key-copy-btn" onclick="copyToClipboard('${computedHashId}')">üìã Copy</button>
                        </div>
                        <div class="key-value" id="${computedHashId}">${data.computed_hash}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üõ°Ô∏è</span> Algorithm</div>
                        <div class="key-value">${data.algorithm}</div>
                    </div>
                    <div class="key-item">
                        <div class="key-label"><span>üìä</span> Result</div>
                        <div class="key-value">${verified ? '‚úÖ Match - Authentic' : '‚ùå Mismatch - May be corrupted'}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('verify-result').innerHTML = html;
        }

        // Clear forms
        function clearForm(formName) {
            document.getElementById(`${formName}-form`).reset();
            document.getElementById(`${formName}-result`).innerHTML = '';
            showAlert('üóëÔ∏è Form cleared', 'success');
        }

        function clearCompare() {
            document.getElementById('compare-hash1').value = '';
            document.getElementById('compare-hash2').value = '';
            document.getElementById('compare-result').innerHTML = '';
            showAlert('üóëÔ∏è Form cleared', 'success');
        }

        // Check backend health on load
        async function checkHealth() {
            try {
                const response = await fetch(`${API_BASE}/../health`);
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    console.log('‚úÖ Backend connected:', data.version);
                    setTimeout(() => {
                        showAlert('üü¢ Connected to INFOCRYPT backend', 'success');
                    }, 500);
                }
            } catch (error) {
                console.error('‚ö†Ô∏è Backend connection failed:', error);
                showAlert('‚ö†Ô∏è Backend connection failed. Please check if server is running.', 'error');
            }
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            console.log('%cüõ°Ô∏è INFOCRYPT v3.0', 'font-size: 20px; font-weight: bold; color: #ff6b35;');
            console.log('%cProfessional Cryptographic Suite', 'font-size: 12px; color: #00d4aa;');
            checkHealth();
        });

        // Make functions global
        window.switchTab = switchTab;
        window.copyToClipboard = copyToClipboard;
        window.handleHash = handleHash;
        window.handleEncrypt = handleEncrypt;
        window.handleDecrypt = handleDecrypt;
        window.handleKeyGen = handleKeyGen;
        window.compareHashes = compareHashes;
        window.handleVerify = handleVerify;
        window.clearForm = clearForm;
        window.clearCompare = clearCompare;
    </script>
</body>
</html>